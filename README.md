# FileFinder

ÐœÐ¾Ñ‰Ð½Ð°Ñ ÐºÑ€Ð¾ÑÑÐ¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼ÐµÐ½Ð½Ð°Ñ CLI-ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ð° Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð¿Ð¾ Ñ„Ð°Ð¹Ð»Ð°Ð¼ Ð¸ Ð°Ñ€Ñ…Ð¸Ð²Ð°Ð¼ Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð², whitelist/blacklist
Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹, Ð¿Ð¾Ð¸ÑÐºÐ° Ð² Ð³Ð»ÑƒÐ±Ð¸Ð½Ñƒ, fail-fast Ð¸ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.

---

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚

1. **Ð¡Ð¾Ð±ÐµÑ€Ð¸**
    ```bash
    go build -o filefinder ./cmd/finder.go
    ```

2. **Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ñ„Ð°Ð¹Ð» Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð²**  
   ÐŸÑ€Ð¸Ð¼ÐµÑ€ `patterns.txt`:
    ```
    re:\bsecret\b
    plain:password
    plain:i:Token
    ```

3. **Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸**
    ```bash
    ./filefinder --pattern-file patterns.txt --whitelist txt,log --archives --threads 8 /var/log
    ```

---

## ðŸ”¥ ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ„Ð¸Ñ‡Ð¸

- ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð´Ð¸ÑÐºÐ°Ð¼ Ð¸ Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼ Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑÐ¼ (Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ root Ð´Ð»Ñ Windows, Linux, MacOS)
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð°Ñ€Ñ…Ð¸Ð²Ð¾Ð²: `zip`, `tar`, `gz`, `bz2`, `xz`, `rar`
- Ð“Ð¸Ð±ÐºÐ°Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ: whitelist Ð¸ blacklist Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹
- Ð“Ð»ÑƒÐ±Ð¸Ð½Ð° Ð¿Ð¾Ð¸ÑÐºÐ° (`--depth N`)
- Fail-fast: Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ð¾ÑˆÐ¸Ð±ÐºÐµ (`--fail-fast`)
- ÐœÐ½Ð¾Ð³Ð¾Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ (Ð²Ñ‹Ð±Ð¸Ñ€Ð°Ð¹ â€” Ñ…Ð¾Ñ‚ÑŒ 100+ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²!)
- Ð›Ð¸Ð¼Ð¸Ñ‚ Ð½Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð² Ð°Ñ€Ñ…Ð¸Ð²Ðµ (Ð°Ð½Ñ‚Ð¸ zip-Ð±Ð¾Ð¼Ð±Ð°)
- ÐšÑ€Ð°ÑÐ¸Ð²Ñ‹Ð¹ Ð»Ð¾Ð³, Ð¾Ñ‚Ñ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð¸Ñ‚Ð¾Ð³Ð°Ð¼ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

---

## ðŸ› ï¸ ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸

| Ð¤Ð»Ð°Ð³                    | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ                                                                                    | ÐŸÑ€Ð¸Ð¼ÐµÑ€                              |
|-------------------------|---------------------------------------------------------------------------------------------|-------------------------------------|
| `--pattern-file`        | ÐŸÑƒÑ‚ÑŒ Ðº Ñ„Ð°Ð¹Ð»Ñƒ Ñ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°Ð¼Ð¸ (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½)                                                      | `--pattern-file patterns.txt`       |
| `--whitelist`           | Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ€Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½Ð½Ñ‹Ñ… Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹ (Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ)                                               | `--whitelist txt,log`               |
| `--blacklist`           | Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ñ… Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹                                                              | `--blacklist jpg,png`               |
| `--logfile`             | ÐŸÑƒÑ‚ÑŒ Ðº Ñ„Ð°Ð¹Ð»Ñƒ Ð»Ð¾Ð³Ð° (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ stdout)                                                     | `--logfile finder.log`              |
| `--threads`             | ÐšÐ¾Ð»-Ð²Ð¾ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² (Ð²Ð¾Ñ€ÐºÐµÑ€Ð¾Ð²)                                                                   | `--threads 8`                       |
| `--save-full`           | Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÑ‚ÑŒ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ„Ð°Ð¹Ð» Ð¿Ñ€Ð¸ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¸ (Ð° Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑ‚Ñ€Ð¾ÐºÐ¸)                                | `--save-full`                       |
| `--save-full-folder`    | ÐŸÐ°Ð¿ÐºÐ° Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð², Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ `/found_files`                                   | `--save-full-folder ./../result`    |
| `--save-matches-file`   | Ð¤Ð°Ð¹Ð» Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº Ð² Ð¾Ð´Ð¸Ð½ Ñ„Ð°Ð¹Ð»                                        | `--save-matches-file result.txt`    |  
| `--save-matches-folder` | ÐŸÐ°Ð¿ÐºÐ° Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº Ð² Ñ„Ð°Ð¹Ð»Ñ‹ Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð° Ð¿Ð¾ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼Ñƒ Ð¾Ð½Ð¸ Ð±Ñ‹Ð»Ð¸ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹ | `--save-matches-folder ./../result` |  
| `--archives`            | Ð˜ÑÐºÐ°Ñ‚ÑŒ Ð¸ Ð² Ð°Ñ€Ñ…Ð¸Ð²Ð°Ñ…                                                                          | `--archives`                        |
| `--depth`               | Ð“Ð»ÑƒÐ±Ð¸Ð½Ð° Ð¿Ð¾Ð¸ÑÐºÐ° (0 â€” Ð±ÐµÐ·Ð»Ð¸Ð¼Ð¸Ñ‚)                                                               | `--depth 3`                         |
| `--timeout`             | ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ñ‚ÑŒ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾Ð¸ÑÐºÐ° (Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 10m, 1h)                                                   | `--timeout 10m`                     |
| `--fail-fast`           | ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒÑÑ Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ð¾ÑˆÐ¸Ð±ÐºÐµ                                                               | `--fail-fast`                       |

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**

```bash
./filefinder --pattern-file patterns.txt --whitelist txt,log --archives --threads 8 --depth 2 /home /mnt/flash
```

---

## ðŸŽ¯ Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð²

Ð¤Ð°Ð¹Ð» Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð² â€” ÑÑ‚Ð¾ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð», Ð³Ð´Ðµ ÐºÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° ÑÑ‚Ð¾ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ Ð¿Ð¾Ð¸ÑÐºÐ°:

```
re: â€” Ñ€ÐµÐ³ÑƒÐ»ÑÑ€ÐºÐ°, Go-style (re:Ð¿Ð°Ñ€Ð¾Ð»ÑŒ\d+)
plain: â€” Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÑ‚Ñ€Ð¾ÐºÐ° (Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñƒ)
plain:i: â€” Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÑ‚Ñ€Ð¾ÐºÐ°, Ð½Ðµ Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñƒ
```

---

## ðŸ“ ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð·Ð°Ð¿ÑƒÑÐºÐ°

ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð´Ð¸ÑÐºÐ°Ð¼:

```bash
./filefinder --pattern-file patterns.txt
```

Ð¡ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð¼ Ð¿Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸ÑÐ¼ Ð¸ Ð³Ð»ÑƒÐ±Ð¸Ð½Ð¾Ð¹:

```bash
./filefinder --pattern-file patterns.txt --whitelist txt,md,log --depth 2 /home/user/Documents
```

ÐŸÐ¾Ð¸ÑÐº Ð² Ð°Ñ€Ñ…Ð¸Ð²Ð°Ñ… Ð¸ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½Ð° Ð¾ÑˆÐ¸Ð±ÐºÐµ:

```bash
./filefinder --pattern-file patterns.txt --archives --fail-fast /var/data
```

---

## ðŸ’¡ FAQ

* Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ, ÐµÑÐ»Ð¸ Ð¸Ñ‰ÐµÑ‚ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð¾Ð»Ð³Ð¾?
  ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÑŒ Ð³Ð»ÑƒÐ±Ð¸Ð½Ñƒ Ñ‡ÐµÑ€ÐµÐ· `--depth N` Ð¸Ð»Ð¸ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ð¾Ð¼ `--timeout 5m`.

* ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ?
  ÐÐµ Ð·Ð°Ð±ÑƒÐ´ÑŒ Ñ„Ð»Ð°Ð³ `--pattern-file`.

* ÐœÐ¾Ð¶Ð½Ð¾ Ð»Ð¸ Ð¸ÑÐºÐ°Ñ‚ÑŒ Ð¿Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¼ Ð¿Ð°Ð¿ÐºÐ°Ð¼?
  Ð”Ð°, Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÐ´Ð°Ð¹ Ð¸Ñ… Ð² ÐºÐ¾Ð½Ñ†Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:

```bash
 ./filefinder ... /home /mnt/usb
```

* Ð“Ð´Ðµ Ð»Ð¾Ð³?
  ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð² `stdout`, Ð¸Ð»Ð¸ Ð·Ð°Ð´Ð°Ð¹ Ñ„Ð»Ð°Ð³Ð¾Ð¼ `--logfile`.

---

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÑ‘ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‚Ð°Ðº:

```bash
go test ./internal/scanner/...
```

---

## âš ï¸ ÐÐ½Ñ‚Ð¸ zip-bomb

Ð’ Ð°Ñ€Ñ…Ð¸Ð²Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð½Ðµ Ð±Ð¾Ð»ÑŒÑˆÐµ 10 000 Ñ„Ð°Ð¹Ð»Ð¾Ð² â€” Ð¸Ð½Ð°Ñ‡Ðµ ÑÐºÐ¸Ð¿Ð°ÐµÑ‚ÑÑ (Ð¸Ð½Ñ„Ð° Ð² Ð»Ð¾Ð³Ðµ).

---

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚ Ñ Docker Compose

1. **ÐŸÐ¾Ð»Ð¾Ð¶Ð¸ ÑÐ²Ð¾Ð¸ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸ `patterns.txt` Ð² Ð¿Ð°Ð¿ÐºÑƒ `data/`.**
2. (ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ð¿Ð°Ð¿ÐºÑƒ `found_files/` Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹ Ñ `--save-full-folder`.
3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸:

    ```bash
    docker-compose up --build
    ```

4. Ð›Ð¾Ð³Ð¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿Ñ€ÑÐ¼Ð¾ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸, Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ð¾Ð¸ÑÐºÐ° â€” Ð² Ñ‚Ð¾Ð¼ Ð¶Ðµ `found_files/` (ÐµÑÐ»Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ð¸ÑˆÑŒ).

**Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð·Ð°Ð¿ÑƒÑÐºÐ° (Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹, Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ, Ð³Ð»ÑƒÐ±Ð¸Ð½Ð°) Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€ÑÐ¼Ð¾ Ð² `docker-compose.yml`, ÑÐµÐºÑ†Ð¸Ñ `command:`.**

---

## â„¹ï¸ ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ°:

```
FileFinder/
â”œâ”€â”€ data/
â”‚ â”œâ”€â”€ patterns.txt
â”‚ â””â”€â”€ ... (Ð»ÑŽÐ±Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸ Ð¿Ð°Ð¿ÐºÐ¸ Ð´Ð»Ñ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ)
â”œâ”€â”€ found_files/ # ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚Ðµ --save-full-folder
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ ... (Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´)
```

---

### âš¡ï¸ ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ð¼ Ð½Ð°Ð±Ð¾Ñ€Ð¾Ð¼ Ñ„Ð»Ð°Ð³Ð¾Ð²:

```yaml
command: >
  --pattern-file /data/patterns.txt
  --whitelist txt,log
  --archives
  --threads 16
  --depth 3
  --save-full
  --save-full-folder /found_files
  /data