# FileFinder

–ú–æ—â–Ω–∞—è –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è CLI-—É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º –∏ –∞—Ä—Ö–∏–≤–∞–º —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, whitelist/blacklist
—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –ø–æ–∏—Å–∫–∞ –≤ –≥–ª—É–±–∏–Ω—É, fail-fast –∏ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–°–æ–±–µ—Ä–∏**
    ```bash
    go build -o filefinder ./cmd/finder.go
    ```

2. **–°–æ–∑–¥–∞–π —Ñ–∞–π–ª –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**  
   –ü—Ä–∏–º–µ—Ä `patterns.txt`:
    ```
    re:\bsecret\b
    plain:password
    plain:i:Token
    ```

3. **–ó–∞–ø—É—Å—Ç–∏**
    ```bash
    ./filefinder --pattern-file patterns.txt --whitelist txt,log --archives --threads 8 /var/log
    ```

---

## üî• –ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏

- –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –¥–∏—Å–∫–∞–º –∏ –≤–Ω–µ—à–Ω–∏–º –Ω–æ—Å–∏—Ç–µ–ª—è–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç root –¥–ª—è Windows, Linux, MacOS)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤: `zip`, `tar`, `gz`, `bz2`, `xz`, `rar`
- –ì–∏–±–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è: whitelist –∏ blacklist —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ (`--depth N`)
- Fail-fast: –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ (`--fail-fast`)
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (–≤—ã–±–∏—Ä–∞–π ‚Äî —Ö–æ—Ç—å 100+ –ø–æ—Ç–æ–∫–æ–≤!)
- –õ–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –∞—Ä—Ö–∏–≤–µ (–∞–Ω—Ç–∏ zip-–±–æ–º–±–∞)
- –ö—Ä–∞—Å–∏–≤—ã–π –ª–æ–≥, –æ—Ç—á—ë—Ç –ø–æ –∏—Ç–æ–≥–∞–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üõ†Ô∏è –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –§–ª–∞–≥                 | –û–ø–∏—Å–∞–Ω–∏–µ                                                     | –ü—Ä–∏–º–µ—Ä                           |
|----------------------|--------------------------------------------------------------|----------------------------------|
| `--pattern-file`     | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)                       | `--pattern-file patterns.txt`    |
| `--whitelist`        | –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)                | `--whitelist txt,log`            |
| `--blacklist`        | –°–ø–∏—Å–æ–∫ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π                               | `--blacklist jpg,png`            |
| `--logfile`          | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é stdout)                      | `--logfile finder.log`           |
| `--threads`          | –ö–æ–ª-–≤–æ –ø–æ—Ç–æ–∫–æ–≤ (–≤–æ—Ä–∫–µ—Ä–æ–≤)                                    | `--threads 8`                    |
| `--save-full`        | –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ–∞–π–ª –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏) | `--save-full`                    |
| `--save-full-folder` | –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/found_files`    | `--save-full-folder ./../result` |
| `--archives`         | –ò—Å–∫–∞—Ç—å –∏ –≤ –∞—Ä—Ö–∏–≤–∞—Ö                                           | `--archives`                     |
| `--depth`            | –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ (0 ‚Äî –±–µ–∑–ª–∏–º–∏—Ç)                                | `--depth 3`                      |
| `--timeout`          | –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—Ä–µ–º—è –ø–æ–∏—Å–∫–∞ (–ø—Ä–∏–º–µ—Ä: 10m, 1h)                    | `--timeout 10m`                  |
| `--fail-fast`        | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ                                | `--fail-fast`                    |

**–ü—Ä–∏–º–µ—Ä:**

```bash
./filefinder --pattern-file patterns.txt --whitelist txt,log --archives --threads 8 --depth 2 /home /mnt/flash
```

---

## üéØ –§–æ—Ä–º–∞—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

–§–∞–π–ª –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω –ø–æ–∏—Å–∫–∞:

```
re: ‚Äî —Ä–µ–≥—É–ª—è—Ä–∫–∞, Go-style (re:–ø–∞—Ä–æ–ª—å\d+)
plain: ‚Äî –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∞ (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
plain:i: ‚Äî –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∞, –Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞

–ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –¥–∏—Å–∫–∞–º:

```bash
./filefinder --pattern-file patterns.txt
```

–° —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –∏ –≥–ª—É–±–∏–Ω–æ–π:

```bash
./filefinder --pattern-file patterns.txt --whitelist txt,md,log --depth 2 /home/user/Documents
```

–ü–æ–∏—Å–∫ –≤ –∞—Ä—Ö–∏–≤–∞—Ö –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –æ—à–∏–±–∫–µ:

```bash
./filefinder --pattern-file patterns.txt --archives --fail-fast /var/data
```

---

## üí° FAQ

*  –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –∏—â–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ?
–û–≥—Ä–∞–Ω–∏—á—å –≥–ª—É–±–∏–Ω—É —á–µ—Ä–µ–∑ `--depth N` –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç–æ–º `--timeout 5m`.

*  –ü–æ—á–µ–º—É –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è?
–ù–µ –∑–∞–±—É–¥—å —Ñ–ª–∞–≥ `--pattern-file`.

*  –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–∫–∞—Ç—å –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø–∞–ø–∫–∞–º?
–î–∞, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–π –∏—Ö –≤ –∫–æ–Ω—Ü–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
 ./filefinder ... /home /mnt/usb
```

*  –ì–¥–µ –ª–æ–≥?
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `stdout`, –∏–ª–∏ –∑–∞–¥–∞–π —Ñ–ª–∞–≥–æ–º `--logfile`.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –º–æ–∂–Ω–æ —Ç–∞–∫:

```bash
go test ./internal/scanner/...
```

## ‚ö†Ô∏è –ê–Ω—Ç–∏ zip-bomb

–í –∞—Ä—Ö–∏–≤–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ –±–æ–ª—å—à–µ 10 000 —Ñ–∞–π–ª–æ–≤ ‚Äî –∏–Ω–∞—á–µ —Å–∫–∏–ø–∞–µ—Ç—Å—è (–∏–Ω—Ñ–∞ –≤ –ª–æ–≥–µ).

---

## ü§ò –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥

–î–µ–ª–∞–π PR, –ø—Ä–µ–¥–ª–∞–≥–∞–π —É–ª—É—á—à–µ–Ω–∏—è, –Ω–∞—Ö–æ–¥–∏ –±–∞–≥–∏ ‚Äî –±—É–¥—É —á–∏–Ω–∏—Ç—å!
–î–ª—è –Ω–æ–≤—ã—Ö –∏–¥–µ–π ‚Äî —Å–æ–∑–¥–∞–π Issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏ –º–Ω–µ –≤ Telegram.